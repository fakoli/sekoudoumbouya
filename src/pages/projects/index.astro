---
import PageLayout from '../../layouts/PageLayout.astro';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const sortedProjects = projects.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());

const base = import.meta.env.BASE_URL === '/' ? '' : import.meta.env.BASE_URL.replace(/\/$/, '');
---

<PageLayout title="Projects | Sekou Doumbouya" description="Case studies and technical projects.">
        <section>
                <h1 class="text-4xl font-bold mb-12 text-text">Projects</h1>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-y-10 md:gap-10">
                        {sortedProjects.map((project) => (
                                <article class="bg-surface border border-border rounded-[var(--radius-md)] overflow-hidden shadow-[var(--shadow-soft)] hover:shadow-[var(--shadow-strong)] transition-shadow duration-300">
                                        <div class="p-6">
                                                <div class="flex justify-between items-start mb-4">
                                                        <h2 class="text-xl font-bold text-text">
                                                                <a href={`${base}/projects/${project.id}`} class="hover:text-accent">
                                                                        {project.data.title}
                                                                </a>
                                                        </h2>
                                                        {project.data.featured && (
                                                                <span class="bg-[color:var(--color-accent)]/10 text-accent text-xs font-medium px-2.5 py-0.5 rounded-[var(--radius-sm)]">Featured</span>
                                                        )}
                                                </div>

                                                <p class="text-muted mb-4 line-clamp-3">
                                                        {project.data.description}
                                                </p>

                                                <div class="flex flex-wrap gap-2 mb-4">
                                                        {project.data.tags.map(tag => (
                                                                <span class="text-xs text-muted bg-surface-muted px-2 py-1 rounded-[var(--radius-sm)] border border-border">#{tag}</span>
                                                        ))}
                                                </div>

                                                <div class="flex items-center space-x-4 text-sm font-medium">
                                                        <a href={`${base}/projects/${project.id}`} class="text-accent hover:underline">Read Case Study &rarr;</a>
                                                        {project.data.repository && (
                                                                <a href={project.data.repository} target="_blank" rel="noopener noreferrer" class="text-muted hover:text-text">GitHub</a>
                                                        )}
                                                </div>
                                        </div>
                                </article>
			))}
		</div>
	</section>
</PageLayout>
