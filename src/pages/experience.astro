---
import PageLayout from '../layouts/PageLayout.astro';
import { getCollection } from 'astro:content';

const experience = await getCollection('experience');
const sortedExperience = experience.sort((a, b) => b.data.startDate.valueOf() - a.data.startDate.valueOf());

function formatDate(date: Date) {
	return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
}
---

<PageLayout title="Experience | Sekou Doumbouya" description="Professional experience and career timeline.">
        <section class="max-w-4xl mx-auto px-4 py-12">
                <header class="mb-16">
                        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">Experience</h1>
                        <p class="text-lg text-gray-700 mb-4">Career focus: turning brittle, expensive infrastructure into resilient multi-region platforms across consumer and enterprise SaaS.</p>
                        <p class="text-xl text-gray-600 max-w-2xl leading-relaxed">
                                A timeline of my career building cloud infrastructure, leading engineering teams, and solving scale at world-class organizations.
                        </p>
                </header>

		<div class="relative border-l-2 border-gray-200 ml-3 md:ml-6 space-y-16">
			{sortedExperience.map((entry) => (
				<div class="relative pl-8 md:pl-12">
					{/* Timeline Dot */}
					<div class="absolute -left-[9px] top-2 w-5 h-5 bg-white border-4 border-blue-600 rounded-full"></div>
					
					<div class="flex flex-col md:flex-row md:items-baseline md:justify-between mb-4">
						<div>
							<h2 class="text-2xl font-bold text-gray-900">{entry.data.role}</h2>
							<div class="text-lg font-medium text-blue-600">{entry.data.company}</div>
						</div>
						<div class="text-sm font-medium text-gray-500 mt-1 md:mt-0 bg-gray-50 px-3 py-1 rounded-full border border-gray-100 inline-block w-fit">
							{formatDate(entry.data.startDate)} — {entry.data.endDate ? formatDate(entry.data.endDate) : 'Present'}
						</div>
					</div>

					<div class="mb-6">
						<p class="text-gray-700 text-lg leading-relaxed mb-4 italic border-l-4 border-gray-100 pl-4 py-1">
							{entry.data.description}
						</p>

						{entry.data.achievements.length > 0 && (
							<ul class="space-y-3 mb-6">
								{entry.data.achievements.map(achievement => (
									<li class="flex items-start text-gray-700">
										<span class="mr-3 text-blue-500 mt-1.5 text-xs">●</span>
										<span class="leading-relaxed">{achievement}</span>
									</li>
								))}
							</ul>
						)}
					</div>

					<div class="flex flex-wrap gap-2">
						{entry.data.skills.map(skill => (
							<span class="px-3 py-1 bg-gray-50 text-gray-600 text-xs font-medium rounded-md border border-gray-200">
								{skill}
							</span>
						))}
					</div>
				</div>
			))}
		</div>
	</section>
</PageLayout>
